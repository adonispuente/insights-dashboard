---
"$schema": /metaschema-1.json
version: '1.0'
type: object

additionalProperties: false
properties:
  "$schema":
    type: string
    enum:
    - /app-sre/app-1.yml
  labels:
    "$ref": "/common-1.json#/definitions/labels"

  name:
    type: string

  description:
    type: string

  serviceOwner:
    description: Team or individual who is/are responsible for the running instance of the software.
    type: object
    additionalProperties: false
    properties:
      name:
        type: string
      email:
        type: string
        format: email
    required:
    - name
    - email

  performanceParameters:
    type: object
    additionalProperties: false
    properties:
      SLO:
        "$ref": "/common-1.json#/definitions/serviceLevel"
      SLA:
        "$ref": "/common-1.json#/definitions/serviceLevel"
      statusPage:
        type: string
        format: uri-reference
    required:
    - SLO

  serviceDocs:
    description: List of service docs
    type: array
    items:
      description: Service document link
      type: string

  dependencies:
    type: array
    items:
      "$ref": "/common-1.json#/definitions/crossref"
      "$schemaRef": "/dependencies/dependency-1.yml"

  quayRepos:
    type: array
    items:
      type: object
      additionalProperties: false
      properties:
        org:
          "$ref": "/common-1.json#/definitions/crossref"
          "$schemaRef": "/dependencies/quay-org-1.yml"
        items:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              name:
                type: string
              description:
                type: string
              public:
                type: boolean
            required:
            - name
            - description
            - public
      required:
      - org
      - items

  escalations:
    type: object
    additionalProperties: false
    properties:
      default: &escalations_default
        type: object
        additionalProperties: false
        properties:
          aliases:
            type: array
            items:
              type: string
          emailRecipients:
            type: array
            items:
              type: string
          pagerdutyRecipients:
            type: array
            items:
              type: string
          slackRecipients:
            type: array
            items:
              type: string
        anyOf:
        - required:
          - emailRecipients
        - required:
          - slackRecipients
        - required:
          - pagerdutyRecipients
      warning: *escalations_default
      critical: *escalations_default
    required:
    - warning
    - critical

  endPoints:
    type: array
    items:
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
        description:
          type: string
        url:
          type: string
      required:
      - name
      - description
      - url

  codeComponents:
    type: array
    items:
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
        resource:
          type: string
          enum:
          - upstream
          - cicd
          - saasrepo
        url:
          type: string
      required:
      - name
      - resource
      - url

required:
- "$schema"
- labels
- name
- description
- serviceOwner
- performanceParameters
