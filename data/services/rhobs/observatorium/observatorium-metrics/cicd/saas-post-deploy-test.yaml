---
$schema: /app-sre/saas-file-2.yml

labels:
  service: observatorium

name: saas-observatorium-metrics-e2e-test
description: SaaS tracking file for Observatorium metrics post-deploy test

app:
  $ref: /services/rhobs/observatorium/app.yml

pipelinesProvider:
  $ref: /services/rhobs/observatorium/pipelines/observatorium-pipeline.app-sre-prod-01.yaml

slack:
  workspace:
    $ref: /dependencies/slack/coreos.yml
  channel: team-monitoring-info

managedResourceTypes:
- Job

publishJobLogs: true

imagePatterns:
- quay.io/app-sre/rhobs-e2e

authentication:
  image:
    path: app-sre/quay/app-sre-pull
    field: all

resourceTemplates:
- name: rhobs-e2e-tests-observatorium-metrics
  url: https://github.com/rhobs/configuration
  path: /tests/integration_tests/post-deploy-job-template.yaml
  targets:
  - namespace:
      $ref: /services/rhobs/observatorium/observatorium-metrics/namespaces/observatorium-metrics-stage.yml
    ref: 457f796ae82ffbbb06e694d1a2afea5f9fc3d8ed
    parameters:
      IMAGE: quay.io/app-sre/rhobs-e2e
      IMAGE_TAG: a05b68f
      SUFFIX: observatorium-metrics-tests
      CREDENTIALS_SECRET: rhobs-tenant-staging
      API_URL: https://observatorium.api.stage.openshift.com
    promotion:
      auto: true
      subscribe:
      - observatorium-metrics-stage-deploy-success-channel
