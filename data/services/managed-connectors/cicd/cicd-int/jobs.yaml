---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: managed-connectors

name: ci-int-managed-connectors-jobs

description: 'CI / CD pipelines for Managed Connector Services, a service for provisioning and managing fleets of connector instances.'

app:
  $ref: /services/managed-connectors/app.yaml

instance:
  $ref: /dependencies/ci-int/ci-int.yml

type: jobs

config:
  - project:
      name: managed-connectors
      label: managed-connectors
      node: managed-services
      gl_group: mk-ci-cd
      gl_project: cos-fleet-manager
      jobs:
        - 'gl-build-main-cos-fleet-manager':
            display_name: managed-connectors build main
            timeout: 7200
            branch: main
        - 'gl-pr-check-cos-fleet-manager':
            display_name: managed-connectors pr-check
            timeout: 7200
            branch: main
  - project:
      name: managed-connectors-quay-mirror
      label: managed-connectors-quay-mirror
      node: managed-services
      gl_group: mk-ci-cd
      gl_project: rhoc-image-mirroring
      build_deploy_script_path: ./mirror_to_quay.sh
      jobs:
        - 'gl-timed-cos-quay-mirror':
            display_name: managed-connectors quay-mirror main
            timeout: 7200
            branch: main
            cron_expression: '0 * * * *'  # run every hour
