---
$schema: /openshift/namespace-1.yml

labels: {}

name: app-sre-observability-production
description: production namespace for the app-sre observability stack

cluster:
  $ref: /openshift/app-sre-prod-03/cluster.yml

app:
  $ref: /services/observability/app.yml

environment:
  $ref: /products/app-sre/environments/production.yml

networkPoliciesAllow:
- $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-03.yml

openshiftAcme:
  config:
    $ref: /dependencies/openshift/acme/v4.yml
  accountSecret:
    provider: vault-secret
    path: app-interface/app-sre/app-sre-observability-production/acme-account
    version: 1

managedRoles: true

managedResourceTypes:
- ConfigMap
- Route

openshiftResources:
# Routes
## Prometheus
- provider: resource-template
  type: jinja2
  path: /observability/prometheus.route.yaml
  variables:
    environment: ''
    host: prometheus.app-sre-prod-03.devshift.net
    service_name: nginx-proxy
    target_port: 8080
## Alertmanager
- provider: resource-template
  type: jinja2
  path: /observability/alertmanager.route.yaml
  variables:
    environment: ''
    host: alertmanager.app-sre-prod-03.devshift.net
    service_name: nginx-proxy
    target_port: 8080

## Nginx proxy configmap
- provider: resource-template
  type: jinja2
  path: /observability/nginx-proxy.configmap.yaml
  variables:
    prometheus_server_name: prometheus.app-sre-prod-03.devshift.net
    alertmanager_server_name: alertmanager.app-sre-prod-03.devshift.net
