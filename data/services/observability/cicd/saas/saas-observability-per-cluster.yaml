---
$schema: /app-sre/saas-file-1.yml

labels:
  service: app-sre-observability

name: saas-app-sre-observability-per-cluster
description: saas-app-sre-observability-per-cluster

app:
  $ref: /services/observability/app.yml

instance:
  $ref: /dependencies/ci-int/ci-int.yml

slack:
  workspace:
    $ref: /dependencies/slack/coreos.yml
  channel: sd-app-sre-info

managedResourceTypes:
- Prometheus
- PrometheusRule
- Service
- Subscription
- Alertmanager
- ServiceMonitor

imagePatterns:
- quay.io/app-sre

resourceTemplates:
# Prometheus
- name: prometheus
  path: /openshift/prometheus.template.yaml
  url: https://gitlab.cee.redhat.com/service/app-sre-observability
  parameters:
    VERSION: v2.15.2
    RETENTION: 30d
    PV_SIZE: 50Gi
    WAL_COMPRESSION: true
    LOG_LEVEL: debug
  targets:
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-stage-01.yml
    ref: master
    parameters:
      CLUSTER_LABEL: app-sre-stage-01
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.app-sre-stage-01.devshift.net
      RETENTION: 30d
      LOG_LEVEL: info
      VERSION: v2.22.0
      PV_SIZE: 150Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-stage-02.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: app-sre-stage-02
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.app-sre-stage-02.devshift.net
      RETENTION: 30d
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsres03ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: appsres03ue1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.appsres03ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsres04ue2.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: appsres04ue2
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.appsres04ue2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcs02ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: crcs02ue1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.crcs02ue1.devshift.net
      PV_SIZE: 100Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivei01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hivei01ue1
      ENVIRONMENT: integration
      EXTERNAL_URL: https://prometheus.hivei01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hive-stage-01.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hive-stage-01
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.hive-stage-01.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hives02ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hives02ue1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.hives02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hivep01ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.hivep01ue1.devshift.net
      PV_SIZE: 100Gi
      PROMETHEUS_RESOURCES:
        limits:
          memory: 5Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep02ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hivep02ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.hivep02ue1.devshift.net
      PV_SIZE: 100Gi
      PROMETHEUS_RESOURCES:
        limits:
          memory: 5Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep03uw1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hivep03uw1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.hivep03uw1.devshift.net
      PV_SIZE: 100Gi
      PROMETHEUS_RESOURCES:
        limits:
          memory: 5Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep04ew2.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: hivep04ew2
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.hivep04ew2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quays02ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: quays02ue1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.quays02ue1.devshift.net
      RETENTION: 30d
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-01.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: app-sre-prod-01
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.app-sre-prod-01.devshift.net
      PV_SIZE: 100Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-03.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: app-sre-prod-03
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.app-sre-prod-03.devshift.net
      RETENTION: 30d
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-04.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: app-sre-prod-04
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.app-sre-prod-04.devshift.net
      PV_SIZE: 150Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsrep05ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: appsrep05ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.appsrep05ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp03ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: quayp03ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.quayp03ue1.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrwp01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: ocmquayrwp01ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.ocmquayrwp01ue1.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: ocmquayrop01ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.ocmquayrop01ue1.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01uw2.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: ocmquayrop01uw2
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.ocmquayrop01uw2.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01ew1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: ocmquayrop01ew1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.ocmquayrop01ew1.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp04ue2.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: quayp04ue2
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.quayp04ue2.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp05ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: quayp05ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.quayp05ue1.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.telemeter-prod-01.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: telemeter-prod-01
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.telemeter-prod-01.devshift.net
      LOG_LEVEL: info
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcp01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: crcp01ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.crcp01ue1.devshift.net
      RETENTION: 28d
      PV_SIZE: 100Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcgovs02ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: crcgovs02ue1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://prometheus.crcgovs02ue1.devshift.net
      RETENTION: 28d
      PV_SIZE: 100Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcgovp01ue1.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: crcgovp01ue1
      ENVIRONMENT: production
      EXTERNAL_URL: https://prometheus.crcgovp01ue1.devshift.net
      RETENTION: 28d
      PV_SIZE: 100Gi
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.c-rh-c-eph.yml
    ref: c88c6fbb94cdf1489805a32997e613c89a48154e
    parameters:
      CLUSTER_LABEL: c-rh-c-eph
      ENVIRONMENT: ephemeral
      EXTERNAL_URL: https://prometheus.c-rh-c-eph.devshift.net
      RETENTION: 28d
      PV_SIZE: 100Gi
# Alertmanager
- name: alertmanager
  path: /openshift/alertmanager.template.yaml
  url: https://gitlab.cee.redhat.com/service/app-sre-observability
  parameters:
    REPLICAS: 3
    VERSION: v0.20.0
    OAUTH_PROXY_SECRET_NAME: alertmanager-auth-proxy
    STORAGE_CLASS_NAME: gp2
    LOG_LEVEL: info
    ALERTMANAGER_NAME: instance
  targets:
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-stage-01.yml
    ref: master
    parameters:
      REPLICAS: 1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.app-sre-stage-01.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-stage-02.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.app-sre-stage-02.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsres03ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      REPLICAS: 1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.appsres03ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsres04ue2.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      REPLICAS: 1
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.appsres04ue2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcs02ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.crcs02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivei01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: integration
      EXTERNAL_URL: https://alertmanager.hivei01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hive-stage-01.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.hive-stage-01.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hives02ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.hives02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.hivep01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep02ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.hivep02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep03uw1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.hivep03uw1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.hivep04ew2.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.hivep04ew2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quays02ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.quays02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-01.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.app-sre-prod-01.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-03.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.app-sre-prod-03.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.app-sre-prod-04.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.app-sre-prod-04.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.appsrep05ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.appsrep05ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp03ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.quayp03ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrwp01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.ocmquayrwp01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.ocmquayrop01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01uw2.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.ocmquayrop01uw2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.ocmquayrop01ew1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.ocmquayrop01ew1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp04ue2.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.quayp04ue2.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.quayp05ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.quayp05ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.telemeter-prod-01.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.telemeter-prod-01.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcp01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.crcp01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcgovs02ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: staging
      EXTERNAL_URL: https://alertmanager.crcgovs02ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.crcgovp01ue1.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: production
      EXTERNAL_URL: https://alertmanager.crcgovp01ue1.devshift.net
  - namespace:
      $ref: /services/observability/namespaces/openshift-customer-monitoring.c-rh-c-eph.yml
    ref: 452840a662c272e2e1bcba22e221683468a7467a
    parameters:
      ENVIRONMENT: ephemeral
      EXTERNAL_URL: https://alertmanager.c-rh-c-eph.devshift.net
