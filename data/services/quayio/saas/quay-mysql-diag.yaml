---
$schema: /app-sre/saas-file-2.yml

labels:
  service: quayio

name: quay-mysql-diag
description: quayio

app:
  $ref: /services/quayio/app.yml

pipelinesProvider:
  $ref: /services/quayio/pipelines/tekton.quayio-pipelines.app-sre-prod-01.yaml

slack:
  workspace:
    $ref: /dependencies/slack/coreos.yml
  channel: oncall-quay

managedResourceTypes:
- CronJob

imagePatterns:
- quay.io/app-sre/quay-mysql-diag

resourceTemplates:
- name: quay-mysql-diag
  path: /openshift/cronjob.yaml
  url: https://github.com/app-sre/quay-mysql-diag
  parameters:
    MYSQL_DEFAULTS_EXTRA_FILE: app-sre-diag-mysql-defaults-extra-file
    AWS_S3_SECRET: quay-mysql-diag-s3
    IMAGE_PULL_POLICY: IfNotPresent
  targets:
  - namespace:
      $ref: /services/quayio/namespaces/quay-mysql-diag.quays02ue1.yaml
    ref: master
    parameters:
      SCHEDULE: "0 * * * *"
  - namespace:
      $ref: /services/quayio/namespaces/quay-mysql-diag.quayp05ue1.yaml
    ref: cdb0c626c2c37e3937bca97cd6b1757c04b7be9c
