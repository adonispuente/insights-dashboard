---
$schema: /vault-config/instance-1.yml

labels:
  service: vault.devshift.net

name: "vault-devshift-net"
description: "Primary App SRE Vault instance"

address: "https://vault.devshift.net"

auth:
  provider: "approle"
  secretEngine: "kv_v1"
  roleID:
    path: "app-sre/ci-int/vault-manager-creds"
    field: "role_id"
  secretID:
    path: "app-sre/ci-int/vault-manager-creds"
    field: "secret_id"

replication:
- vaultInstance:
    $ref: /services/vault.devshift.net/config/ci-ext/ci-ext.yml
  sourceAuth:
    provider: "approle"
    secretEngine: "kv_v1"
    roleID:
      path: "app-sre/creds/vault-replication-approle-main"
      field: "role_id"
    secretID:
      path: "app-sre/creds/vault-replication-approle-main"
      field: "secret_id"

  destAuth:
    provider: "approle"
    secretEngine: "kv_v1"
    roleID:
      path: "app-sre/creds/vault-replication-approle-ci-ext"
      field: "role_id"
    secretID:
      path: "app-sre/creds/vault-replication-approle-ci-ext"
      field: "secret_id"

  paths:
  - provider: "jenkins"
    jenkinsInstance:
      $ref: /dependencies/ci-ext/ci-ext.yml
  - provider: "policy"
    policy:
      $ref: /services/vault.devshift.net/config/ci-ext/policies/replication-policies/insights-qe-replication-policy.yml
