---
$schema: /vault-config/policy-1.yml

labels:
  service: vault.devshift.net

name: "app-sre-policy"
instance:
  $ref: /services/vault.devshift.net/config/prod/devshift-net.yml
rules: |
  path "devtools-osio-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "app-sre/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "app-interface/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "sd-uhc/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "osd-sre/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "osd-sre-cicd/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "osde2e/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "cs-sre/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "cs-sre-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "mt-sre/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "insights/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "insights-cicd/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "control-plane-service/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "hybrid-cloud-gateway/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "hacbs/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "quay/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "rhmi/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "rhobs/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "rhose/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "managed-application-services/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "managed-services/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "managed-services-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "managed-connectors-services/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "image-builder-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "cna-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "acs-fleet-manager-ci/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }

  path "totp/app-sre/keys/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
  path "totp/app-sre/code/*" {
    capabilities = ["read", "list"]
  }

  # https://www.vaultproject.io/api/system/audit-hash#calculate-hash
  path "/sys/audit-hash/file" {
    capabilities = ["create", "read", "update"]
  }

  #allow vault seal/unseal
  path "/sys/seal" {
    policy = "sudo"
  }
  path "/sys/unseal" {
    policy = "sudo"
  }

  path "status-board-refresh/*" {
    capabilities = ["create", "read", "update", "delete", "list"]
  }
