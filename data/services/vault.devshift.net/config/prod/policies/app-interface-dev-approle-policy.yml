---
$schema: /vault-config/policy-1.yml

labels:
  service: vault.devshift.net

name: "app-interface-development-approle-policy"
instance:
  $ref: /services/vault.devshift.net/config/prod/devshift-net.yml

# The intent is to remove the ability for development credentials to write or
# update any data in Vault. This is only a modest improvement to start, but
# it is at least a starting point. From here, the intent is to gradually
# remove privileges until we have something that works for many use cases.
rules: |
  path "app-sre/creds/*" {
    capabilities = ["read"]
  }
  path "app-sre/ansible/*" {
    capabilities = ["read"]
  }
  path "app-sre/ci-int/*" {
    capabilities = ["read"]
  }
  path "app-sre/ci-ext/*" {
    capabilities = ["read"]
  }
  path "app-sre/ci-stage/*" {
    capabilities = ["read"]
  }
  path "app-sre/quay/*" {
      capabilities = ["read"]
    }
  path "app-sre/ocm-quay/*" {
      capabilities = ["read"]
    }
  path "app-sre/unleash/*" {
      capabilities = ["read"]
    }
  path "app-sre/dashdot/*" {
      capabilities = ["read"]
    }
  path "app-sre/pgp-reencrypt/*" {
      capabilities = ["read", "list"]
    }
  path "osde2e/*" {
     capabilities = ["read"]
  }
  path "sd-uhc/*" {
    capabilities = ["read"]
  }
  path "ocm-qe/*" {
    capabilities = ["read"]
  }
  path "redhat-qe/*" {
    capabilities = ["read"]
  }
  path "osd-sre/*" {
     capabilities = ["read"]
  }
  path "cs-sre/*" {
     capabilities = ["read"]
  }
  path "mt-sre/*" {
     capabilities = ["read"]
  }
  path "insights/*" {
     capabilities = ["read"]
  }
  path "control-plane-service/*" {
     capabilities = ["read"]
  }
  path "hybrid-cloud-gateway/*" {
     capabilities = ["read"]
  }
  path "hacbs/*" {
     capabilities = ["read"]
  }
  path "stonesoup/*" {
     capabilities = ["read"]
  }
  path "rhmi/*" {
    capabilities = ["read"]
  }
  path "rhobs/*" {
    capabilities = ["read"]
  }
  path "rhose/*" {
    capabilities = ["read"]
  }
  path "managed-services/*" {
    capabilities = ["read"]
  }
  path "managed-services-ci/*" {
    capabilities = ["read"]
  }
  path "image-builder-ci/*" {
    capabilities = ["read"]
  }
  #app-interface secrets integration
  path "app-interface/*" {
     capabilities = ["read"]
  }
  # integrations input/output
  path "app-sre/integrations-input/*" {
    capabilities = ["read"]
  }
  # RHIDP capability needs read/write/list permissions
  path "app-sre/integrations-input/rhidp/*" {
    capabilities = ["create", "update", "read", "list", "delete"]
  }
  # Change: this was made read-only
  path "app-sre/integrations-output/*" {
    capabilities = ["read"]
  }
  # Change: this was made read-only
  path "app-sre/integrations-throughput/*" {
    capabilities = ["read"]
  }
  path "acs-fleet-manager-ci/*" {
    capabilities = ["read"]
  }
