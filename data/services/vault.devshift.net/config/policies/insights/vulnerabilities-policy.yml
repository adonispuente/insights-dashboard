---
$schema: /vault-config/policy-1.yml

labels:
  service: vault.devshift.net

name: "insights-vulnerabilities-policy"
instance:
  $ref: /services/vault.devshift.net/config/instances/devshift-net.yml
rules: |
  path "insights/data/secrets/insights-dev/vulnerability-engine-ci/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-dev/vulnerability-engine-qa/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-prod/vulnerability-engine-prod/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-stage/vulnerability-engine-stage/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-fedramp-stage/vulnerability-engine-fedramp-stage/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-dev/vmaas-ci/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-dev/vmaas-qa/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-prod/vmaas-prod/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-stage/vmaas-stage/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-fedramp-stage/vmaas-fedramp-stage/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-stage/ocp-vulnerability-stage/*" {
    capabilities = ["create", "read", "update"]
  }
