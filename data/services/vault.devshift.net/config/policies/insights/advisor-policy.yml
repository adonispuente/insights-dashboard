---
$schema: /vault-config/policy-1.yml

labels:
  service: vault.devshift.net

name: "insights-advisor-policy"
rules: |
  path "insights/metadata/secrets/" {
    capabilities = ["list"]
  }

  path "insights/metadata/secrets/insights-dev/advisor-ci/" {
    capabilities = ["list"]
  }
  path "insights/metadata/secrets/insights-dev/advisor-qa/" {
    capabilities = ["list"]
  }
  path "insights/metadata/secrets/insights-prod/advisor-prod/" {
    capabilities = ["list"]
  }
  path "insights/metadata/secrets/insights-stage/advisor-stage/" {
    capabilities = ["list"]
  }

  path "insights/metadata/secrets/insights-dev/advisor-ci/*" {
    capabilities = ["list", "read"]
  }
  path "insights/metadata/secrets/insights-dev/advisor-qa/*" {
    capabilities = ["list", "read"]
  }
  path "insights/metadata/secrets/insights-prod/advisor-prod/*" {
    capabilities = ["list", "read"]
  }
  path "insights/metadata/secrets/insights-stage/advisor-stage/*" {
    capabilities = ["list", "read"]
  }

  path "insights/data/secrets/insights-dev/advisor-ci/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-dev/advisor-qa/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-prod/advisor-prod/*" {
    capabilities = ["create", "read", "update"]
  }
  path "insights/data/secrets/insights-stage/advisor-stage/*" {
    capabilities = ["create", "read", "update"]
  }
