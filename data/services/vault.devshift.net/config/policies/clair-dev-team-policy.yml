---
$schema: /vault-config/policy-1.yml

labels:
  service: vault.devshift.net

name: "clair-dev-team-policy"
rules: |
  path "clair/metadata/" {
    capabilities = ["list"]
  }

  # clair-stage
  path "clair/metadata/clair-stage/" {
    capabilities = ["list"]
  }
  path "clair/metadata/clair-stage/*" {
    capabilities = ["list", "read"]
  }
  path "clair/data/clair-stage/*" {
    capabilities = ["create", "update", "read"]
  }

  # clair-production
  path "clair/metadata/clair-production/" {
    capabilities = ["list"]
  }
  path "clair/metadata/clair-production/*" {
    capabilities = ["list", "read"]
  }
