---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: metering

name: ci-ext-metering-jobs

description: ''

instance:
  $ref: /dependencies/ci-ext/ci-ext.yml

type: jobs

config:
# runs on PRs and runs oc process to dry-run template our openshift templates
- project:
    name: metering-saas-pre-checks
    label: metering
    node: metering
    gh_org: app-sre
    gh_repo: saas-metering
    # unused since we don't build images. must have a corresponding secret in vault however so use app-re
    quay_org: app-sre
    kube_cluster: app-sre-stage
    kube_namespace: telemeter-metering-stage
    saasherder_context: metering
    jobs:
    - 'saas-pr-check':
        display_name: saas-metering pr check

# runs on master
- project:
    name: metering-saas-deploy
    label: metering
    node: metering
    gh_org: app-sre
    gh_repo: saas-metering
    # unused since we don't build images. must have a corresponding secret in vault however so use app-re
    quay_org: app-sre
    kube_cluster: app-sre-stage
    kube_namespace: telemeter-metering-stage
    saasherder_context: metering
    jobs:
    - 'saas-deploy':
        display_name: saas-metering deploy
