---
$schema: /openshift/namespace-1.yml

labels:
  service: stonesoup

name: stonesoup-infra-stage

description: Staging namespace for StoneSoup infra (RDS databases)

cluster:
  $ref: /openshift/app-sre-stage-01/cluster.yml

app:
  $ref: /services/stonesoup/app.yml

environment:
  $ref: /products/stonesoup/environments/stage.yml

managedExternalResources: true

externalResources:
- provider: aws
  provisioner:
    $ref: /aws/stonesoup-stage/account.yml
  resources:
  # - provider: rds
  #   identifier: redhat-staging-plnsvc
  #   defaults: /terraform/resources/stonesoup/staging/redhat/plnsvc-rds.yml
  #   overrides:
  #     apply_immediately: true
  # - provider: rds
  #   identifier: multi-tenant-staging-plnsvc
  #   defaults: /terraform/resources/stonesoup/staging/multi-tenant/plnsvc-rds.yml
  #   overrides:
  #     apply_immediately: true
  - provider: kms
    identifier: redhat-staging-plnsvc
    region: us-east-1
    defaults: /terraform/resources/stonesoup/staging/redhat/plnsvc-kms.yml
  - provider: kms
    identifier: multi-tenant-staging-plnsvc
    region: us-east-1
    defaults: /terraform/resources/stonesoup/staging/multi-tenant/plnsvc-kms.yml
  - provider: s3
    identifier: redhat-staging-plnsvc
    defaults: /terraform/resources/s3-all-expires-90-days.yml
  - provider: s3
    identifier: multi-tenant-staging-plnsvc
    defaults: /terraform/resources/s3-all-expires-90-days.yml
  # - provider: rds
  #   identifier: redhat-staging-gitopsvc
  #   defaults: /terraform/resources/stonesoup/staging/redhat/gitopsvc-rds.yml
  #   overrides:
  #     apply_immediately: true
  # - provider: rds
  #   identifier: multi-tenant-staging-gitopsvc
  #   defaults: /terraform/resources/stonesoup/staging/multi-tenant/gitopsvc-rds.yml
  #   overrides:
  #     apply_immediately: true
  - provider: kms
    identifier: redhat-staging-gitopsvc
    region: us-east-1
    defaults: /terraform/resources/stonesoup/staging/redhat/gitopsvc-kms.yml
  - provider: kms
    identifier: multi-tenant-staging-gitopsvc
    region: us-east-1
    defaults: /terraform/resources/stonesoup/staging/multi-tenant/gitopsvc-kms.yml
