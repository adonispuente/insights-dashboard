---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: insights-ephemeral

name: ci-int-insights-ephemeral-jobs

description: 'Build pipeline for ephemeral env components'

app:
  $ref: /services/insights/ephemeral/app.yml

instance:
  $ref: /dependencies/ci-int/ci-int.yml

type: jobs

config:
- project:
    name: frontend-build-container
    label: insights
    node: insights
    gl_group: insights-platform
    gl_project: frontend-build-container
    quay_org: cloudservices
    jobs:
    - insights-gl-pr-check:
        display_name: frontend-build-container pr-check
        branch: main
    - insights-gl-build-master:
        display_name: frontend-build-container build-master
        branch: main
- project:
    name: better-platform-docs
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: better-platform-docs
    quay_org: cloudservices
    jobs:
    - insights-gh-pr-check:
        display_name: better-platform-docs pr-check
        branch: main
    - insights-gh-build-master:
        display_name: better-platform-docs build-master
        branch: main
    - insights-gh-build-master-nightly:
        display_name: better-platform-docs nightly
        branch: main
        cron_expression: '0 0 0 * *'

- project:
    name: insights-frontend-builder-common
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: insights-frontend-builder-common
    quay_org: cloudservices
    jobs:
    - insights-gh-pr-check:
        display_name: insights-frontend-builder-common pr-check
    - insights-gh-build-master:
        display_name: insights-frontend-builder-common build-master
        branch: master
- project:
    name: caddy-ubi
    label: insights
    node: insights
    gl_group: insights-platform
    gl_project: caddy-ubi
    quay_org: cloudservices
    jobs:
    - insights-gl-pr-check:
        display_name: caddy-ubi pr-check
        branch: main
    - insights-gl-build-master:
        display_name: caddy-ubi build-master
        branch: main
- project:
    name: cypress-e2e-image
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: cypress-e2e-image
    quay_org: cloudservices
    jobs:
    - insights-gh-pr-check:
        display_name: cypress-e2e-image pr-check
        branch: master
    - insights-gh-build-master:
        display_name: cypress-e2e-image build-master
        branch: master
- project:
    name: insights-chrome
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: insights-chrome
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: insights-chrome pr-check
    - "insights-gh-build-master":
        display_name: insights-chrome build-master
        branch: "master"
    - "insights-gh-build-master":
        display_name: insights-chrome build-master-stable
        branch: "master-stable"

    # Frontends build deploy POC work
    - "insights-gh-pipeline-frontends":
        display_name: insights-chrome frontend-pipeline-pr-check
        status_context: ci.int.devshift.net PR pipeline
        project_name: 'insights-chrome'
        run_cypress_component_stage: 'true'
        run_cypress_e2e_tests_stage: 'true'
        run_frontend_build_stage: 'true'
        run_iqe_tests_stage: 'true'
        run_lint_stage: 'true'
        run_unit_tests_stage: 'true'

- project:
    name: frontend-configs
    label: insights
    node: insights
    gl_group: insights-platform
    gl_project: frontend-configs
    quay_org: cloudservices
    jobs:
    - "insights-gl-pr-check":
        display_name: frontend-configs pr-check
    - "insights-gl-build-master":
        display_name: frontend-configs build-master
- project:
    name: landing-page-frontend
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: landing-page-frontend
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: landing-page-frontend pr-check
    - "insights-gh-build-master":
        display_name: landing-page-frontend build-master
        branch: "master"
    - "insights-gh-build-master":
        display_name: landing-page-frontend build-master-stable
        branch: "master-stable"
    - "insights-gh-build-master":
        display_name: landing-page-frontend build-prod-beta
        branch: "prod-beta"
    - "insights-gh-build-master":
        display_name: landing-page-frontend build-prod-stable
        branch: "prod-stable"
- project:
    name: insights-dashboard
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: insights-dashboard
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: insights-dashboard pr-check
    - "insights-gh-build-master":
        display_name: insights-dashboard build-master
        branch: "master"
    - "insights-gh-build-master":
        display_name: insights-dashboard build-master-stable
        branch: "master-stable"
    - "insights-gh-build-master":
        display_name: insights-dashboard build-prod-stable
        branch: "prod-stable"
    - "insights-gh-build-master":
        display_name: insights-dashboard build-prod-beta
        branch: "prod-beta"
- project:
    name: cloud-services-config
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: cloud-services-config
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: cloud-services-config pr-check
    - "insights-gh-build-master":
        display_name: cloud-services-config build-stage-beta
        branch: "stage-beta"
    - "insights-gh-build-master":
        display_name: cloud-services-config build-stage-stable
        branch: "stage-stable"
    - "insights-gh-build-master":
        display_name: cloud-services-config build-prod-stable
        branch: "prod-stable"
    - "insights-gh-build-master":
        display_name: cloud-services-config build-prod-beta
        branch: "prod-beta"
- project:
    name: iam-console
    label: insights
    node: insights
    gl_group: it-user
    gl_project: iam-console
    quay_org: cloudservices
    jobs:
    - "insights-gl-pr-check":
        display_name: iam-console pr-check
    - "insights-gl-build-master":
        display_name: iam-console build-stage-beta
        branch: "main"
    - "insights-gl-build-master":
        display_name: iam-console build-stage-stable
        branch: "stage-stable"
    - "insights-gl-build-master":
        display_name: iam-console build-prod-stable
        branch: "prod-stable"
    - "insights-gl-build-master":
        display_name: iam-console build-prod-beta
        branch: "prod-beta"
