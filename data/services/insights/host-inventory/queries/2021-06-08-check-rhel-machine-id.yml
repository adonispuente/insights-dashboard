---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2021-06-08-check-rhel-machine-id
namespace:
  $ref: /services/insights/host-inventory/namespaces/prod-host-inventory-prod.yml
identifier: host-inventory-prod
output: stdout
query: |
  SELECT reporter,
  CASE WHEN canonical_facts->>'rhel_machine_id' is null THEN 'n/a'
  WHEN canonical_facts->>'rhel_machine_id' ~ '-' THEN 'dashes' ELSE 'no_dashes'
  END case_result, count(id) FROM hosts GROUP BY reporter, case_result;
