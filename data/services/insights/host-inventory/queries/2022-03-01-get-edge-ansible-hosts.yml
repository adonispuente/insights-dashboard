---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2022-03-01-get-edge-ansible-hosts
namespace:
  $ref: /services/insights/host-inventory/namespaces/prod-host-inventory-prod.yml
identifier: host-inventory-prod
output: stdout
query: |
  SELECT count(1), stale_timestamp, created_on, account, system_profile_facts
  FROM hosts
  WHERE 
    system_profile_facts->>'host_type'  =  'edge' OR 
    system_profile_facts->>'ansible' IS NOT NULL
  GROUP BY stale_timestamp, created_on, account, system_profile_facts
  ORDER BY count desc;
