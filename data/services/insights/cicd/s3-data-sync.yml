---
$schema: /app-sre/saas-file-2.yml

labels:
  service: insights

name: s3-data-sync
description: deploy s3-data-sync job

app:
  $ref: /services/insights/cicd/app.yml

pipelinesProvider:
  $ref: /services/insights/pipelines/tekton.crc-pipelines.appsrep05ue1.yaml

slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: cost-mgmt-bots

managedResourceTypes:
- CronJob

imagePatterns:
- quay.io/cloudservices

parameters:
  NAMESPACE_URL: https://console-openshift-console.apps.appsrep05ue1.zqxk.p1.openshiftapps.com/k8s/ns/s3-data-sync

resourceTemplates:
- name: s3-data-sync
  path: /deploy.yaml
  url: https://gitlab.cee.redhat.com/cost-management/s3-data-sync
  targets:
  - name: hccm-s3-sync
    namespace:
      $ref: /services/insights/cicd/namespaces/s3-data-sync.yml
    ref: bfb51d0f4d817389dcd20c3360d8630b88528358
    parameters:
      NAME: hccm-s3-sync
      SECRET_NAME: hccm-s3-sync
      CRON_SCHEDULE: 0 23 * * *
      DRY_RUN: "false"
  - name: automation-analytics-s3-sync
    namespace:
      $ref: /services/insights/cicd/namespaces/s3-data-sync.yml
    ref: bfb51d0f4d817389dcd20c3360d8630b88528358
    parameters:
      NAME: automation-analytics-s3-sync
      SECRET_NAME: automation-analytics-s3-sync
      CRON_SCHEDULE: 0 6 * * *
      DRY_RUN: "false"
