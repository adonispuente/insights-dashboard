---
$schema: /app-sre/slo-document-1.yml

labels:
  service: quickstarts

name: quickstarts

namespaces:
- $ref: /services/insights/quickstarts/namespaces/quickstarts-stage.yml
- $ref: /services/insights/quickstarts/namespaces/quickstarts-prod.yml

slos:
- name: Requests result in successful (non-5xx) response
  dashboard: https://grafana.stage.devshift.net/d/aqaixAb7k/quickstarts?orgId=1
  SLIType: availability
  SLISpecification: Proportion of sucessful requests with a non-5xx response against all requests on Quickstarts API
  SLOTarget: 0.90
  SLOTargetUnit: percent_0_1
  SLOParameters:
    window: 28d
  SLODetails: https://gitlab.cee.redhat.com/service/app-interface/-/tree/master/docs/console.redhat.com/app-sops/quickstarts/SLO.md
  prometheusRules: /resources/insights-stage/quickstarts-stage/quickstarts.prometheusrules.yml
  expr: |
    1-(quickstarts_responses{code="500"} / quickstarts_responses)
- name: Request latency
  dashboard: https://grafana.stage.devshift.net/d/aqaixAb7k/quickstarts?orgId=1
  SLIType: latency
  SLISpecification: Proportion of requests with less than <2000 ms against all requests on Quickstarts API
  SLOTarget: 0.90
  SLOTargetUnit: percent_0_1
  SLODetails: https://gitlab.cee.redhat.com/service/app-interface/-/tree/master/docs/console.redhat.com/app-sops/quickstarts/SLO.md
  SLOParameters:
    window: 28d
  prometheusRules: /resources/insights-stage/quickstarts-stage/quickstarts.prometheusrules.yml
  expr: |
    sum(api_3scale_gateway_api_time_bucket{exported_service="quickstarts",le="+2000"})
    /
    sum(api_3scale_gateway_api_time_bucket{exported_service="quickstarts",le="+Inf"}) < .90
- name: Requests result in successful (non-5xx) response
  dashboard: https://grafana.app-sre.devshift.net/d/aqaixAb7k/quickstarts?orgId=1
  SLIType: availability
  SLISpecification: Proportion of sucessful requests with a non-5xx response against all requests on Quickstarts API
  SLOTarget: 0.90
  SLOTargetUnit: percent_0_1
  SLOParameters:
    window: 28d
  SLODetails: https://gitlab.cee.redhat.com/service/app-interface/-/tree/master/docs/console.redhat.com/app-sops/quickstarts/SLO.md
  prometheusRules: /resources/insights-prod/quickstarts-prod/quickstarts.prometheusrules.yml
  expr: |
    1-(quickstarts_responses{code="500"} / quickstarts_responses)
- name: Request latency
  dashboard: https://grafana.app-sre.devshift.net/d/aqaixAb7k/quickstarts?orgId=1
  SLIType: latency
  SLISpecification: Proportion of requests with less than <2000 ms against all requests on Quickstarts API
  SLOTarget: 0.90
  SLOTargetUnit: percent_0_1
  SLODetails: https://gitlab.cee.redhat.com/service/app-interface/-/tree/master/docs/console.redhat.com/app-sops/quickstarts/SLO.md
  SLOParameters:
    window: 28d
  prometheusRules: /resources/insights-prod/quickstarts-prod/quickstarts.prometheusrules.yml
  expr: |
    sum(api_3scale_gateway_api_time_bucket{exported_service="quickstarts",le="+2000"})
    /
    sum(api_3scale_gateway_api_time_bucket{exported_service="quickstarts",le="+Inf"}) < .90
