apiVersion: template.openshift.io/v1
kind: Pipeline
metadata:
  name: cleanup_resources-pipeline
spec:
  tasks:
    - name: cloud-resources-cleanup_task
      taskRef:
        name: cloud-resources-cleanup_task
  containers:
    - name: add namespace name here ?
      image: ${IQE_IMAGE} # what image ?
      env: # secrets to provide cloudwash at runtime
        - name:  CLEANUP_PROVIDERS_AZURE_AUTH_CLIENT_ID # app.provisioning.config.DEFAULT_CLOUD_SETTINGS.AZURE.CLIENT_ID
          value: ${DEFAULT_CLOUD_SETTINGS.AZURE.CLIENT_ID}
        - name: CLEANUP_PROVIDERS_AZURE_AUTH_SECRET_ID
          value: ${DEFAULT_CLOUD_SETTINGS.AZURE.CLIENT_SECRET}
        - name: CLEANUP_PROVIDERS_AZURE_AUTH_TENANT_ID
          value: ${DEFAULT_CLOUD_SETTINGS.AZURE.TENANT_ID}
        - name: CLEANUP_PROVIDERS_AZURE_AUTH_SUBSCRIPTION_ID
          value: ${DEFAULT_CLOUD_SETTINGS.AZURE.SUBSCRIPTION_ID}

        - name: DYNACONF_IQE_VAULT_LOADER_ENABLED
          value: "true"
        - name: DYNACONF_IQE_VAULT_VERIFY
          value: "true"
        - name: DYNACONF_IQE_VAULT_URL
          valueFrom:
            secretKeyRef:
              key: url
              name: iqe-vault
              optional: true