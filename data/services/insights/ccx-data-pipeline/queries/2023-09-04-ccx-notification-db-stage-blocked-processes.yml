---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2023-09-04-notification-db-blocked-processes
namespace:
  $ref: /services/insights/ccx-data-pipeline/namespaces/stage-ccx-data-pipeline-stage.yml
identifier: ccx-notification-db-stage
output: stdout
queries:
  - |
    SELECT pid,
       usename,
       pg_blocking_pids(pid) as blocked_by,
       query as blocked_query
    FROM pg_stat_activity
    WHERE cardinality(pg_blocking_pids(pid)) > 0;
