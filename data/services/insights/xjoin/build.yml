---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: xjoin
  platform: insights

name: ci-int-insights-xjoin-kafka-connect-jobs

description: Build job for xjoin-kafka-connect images

app:
  $ref: /services/insights/xjoin/app.yml

instance:
  $ref: /dependencies/ci-int/ci-int.yml

type: jobs

config:
- project:
    name: xjoin-kafka-connect-strimzi
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-kafka-connect
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-kafka-connect build-master
    - insights-gh-build-master:
        display_name: xjoin-kafka-connect build-security-compliance
        branch: security-compliance
    - insights-gh-scheduled-rebuild:
        display_name: xjoin-kafka-connect build-security-compliance-weekly
        branch: security-compliance
        cron_expression: "H H(0-3) * * 6"
        ci_cmd: './build_deploy.sh'

- project:
    name: cyndi-operator
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: cyndi-operator
    quay_org: cloudservices
    jobs:
    - gh-build-master:
        display_name: cyndi-operator build-master
    - gh-build-catalog-master-with-upstream:
        display_name: cyndi-operator build-master-catalog-index
        upstream: RedHatInsights-cyndi-operator-gh-build-master
        bundle_image: quay.io/cloudservices/cyndi-operator-bundle
        catalog_image: quay.io/cloudservices/cyndi-operator-index
    - insights-gh-pr-check:
        display_name: cyndi-operator pr-check
    - insights-gh-build-master:
        display_name: chrome-service build-security-compliance
        branch: security-compliance
    - insights-gh-scheduled-rebuild:
        display_name: cyndi-operator build-security-compliance-weekly
        branch: security-compliance
        cron_expression: "H H(0-3) * * 6"
        ci_cmd: './build_deploy.sh'


- project:
    name: xjoin-api-gateway
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-api-gateway
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-api-gateway build-master
    - insights-gh-pr-check:
        display_name: xjoin-api-gateway pr-check

- project:
    name: xjoin-operator
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-operator
    quay_org: cloudservices
    jobs:
    - gh-build-master:
        display_name: xjoin-operator build-master
    - gh-build-catalog-master-with-upstream:
        display_name: xjoin-operator build-master-catalog-index
        upstream: RedHatInsights-xjoin-operator-gh-build-master
        bundle_image: quay.io/cloudservices/xjoin-operator-bundle
        catalog_image: quay.io/cloudservices/xjoin-operator-index
    - insights-gh-pr-check:
        display_name: xjoin-operator pr check
    - insights-gh-build-master:
        display_name: xjoin-operator build-security-compliance
        branch: security-compliance
    - insights-gh-scheduled-rebuild:
        display_name: xjoin-operator build-security-compliance-weekly
        branch: security-compliance
        cron_expression: "H H(0-3) * * 6"
        ci_cmd: './build_deploy.sh'

- project:
    name: inventory-heartbeat
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: inventory-heartbeat
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: inventory-heartbeat build-master

- project:
    name: xjoin-validation
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-validation
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-validation build-master
    - insights-gh-pr-check:
        display_name: xjoin-validation pr-check

- project:
    name: xjoin-api-subgraph
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-api-subgraph
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-api-subgraph build-master
    - insights-gh-pr-check:
        display_name: xjoin-api-subgraph pr-check

- project:
    name: xjoin-core
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-core
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-core build-master
    - insights-gh-pr-check:
        display_name: xjoin-core pr-check

- project:
    name: xjoin-es-exporter
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-es-exporter
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-es-exporter build-main
        branch: main
    - insights-gh-pr-check:
        display_name: xjoin-es-exporter pr-check
        branch: main

- project:
    name: xjoin-apicurio
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: xjoin-apicurio
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: xjoin-apicurio build-master
        branch: master
    - insights-gh-pr-check:
        display_name: xjoin-apicurio pr-check

- project:
    name: host-inventory-subgraph
    label: insights
    node: insights
    gh_org: RedHatInsights
    gh_repo: host-inventory-subgraph
    quay_org: cloudservices
    jobs:
    - insights-gh-build-master:
        display_name: host-inventory-subgraph build-master
        branch: master
    - insights-gh-pr-check:
        display_name: host-inventory-subgraph pr-check
