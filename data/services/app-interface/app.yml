---
$schema: /app-sre/app-1.yml


labels:
  service: app-interface

name: app-interface

description: |
  This tool serves as a central coordination point for hosted services
  being run by the Application SRE team. Many or all of the portions of the
  contract defined herein will be handled through automation after changes are
  accepted to this repository by the appropriate parties.

architectureDocument: https://TODO
sopsUrl: https://gitlab.cee.redhat.com/TODO
grafanaUrls:
- title: TODOREPLACE
  url: https://TODO
onboardingStatus: OnBoarded

escalationPolicy:
  $ref: /teams/app-sre/escalation-policies/general.yaml
serviceOwners:
- name: App-SRE Team
  email: sd-app-sre@redhat.com

dependencies:
- $ref: /dependencies/aws/service.yml
- $ref: /dependencies/ci-ext/service.yml
- $ref: /dependencies/ci-int/service.yml
- $ref: /dependencies/github/service.yml
- $ref: /dependencies/gitlab/service.yml
- $ref: /dependencies/quay/service.yml
- $ref: /dependencies/openshift/service.yml

sentryProjects:
- team:
    $ref: /dependencies/sentry/teams/app-sre-stage.yml
  projects:
  - name: app-interface-stage
    description: app-interface project in stage
    email_prefix: '[App-Interface Stage]'
    platform: python
- team:
    $ref: /dependencies/sentry/teams/app-sre-production.yml
  projects:
  - name: app-interface-prod
    description: app-interface project in prod
    email_prefix: '[App-Interface Prod]'
    platform: python

quayRepos:
- org:
    $ref: /dependencies/quay/app-sre.yml
  teams:
  - permissions:
    # uhc team (OCM) are using postgres in their CI. this lets them read the repo for local testing
    - $ref: /dependencies/quay/permissions/quay-membership-app-sre-uhc.yml
    role: read
  items:
  - name: qontract-api
    description: ''
    public: true
  - name: qontract-validator
    description: ''
    public: true
  - name: qontract-server
    description: ''
    public: true
  - name: qontract-reconcile
    description: ''
    public: true
  - name: qontract-schemas
    description: ''
    public: true
  - name: app-interface
    description: ''
    public: false
  - name: app-interface-nginx-gate
    description: ''
    public: false
  - name: postgres
    description: Used by the SQL-QUERY integration
    public: false
    mirror:
      $ref: /dependencies/image-mirrors/docker.io/postgres.yml
  - name: mysql
    description: Used by the SQL-QUERY integration
    public: false
    mirror:
      $ref: /dependencies/image-mirrors/docker.io/mysql.yml
  - name: qontract-reconcile-base
    description: Base image for qontract-reconcile
    public: true
  - name: qontract-reconcile-builder
    description: Builder image for qontract-reconcile
    public: true
  - name: internal-redhat-ca
    description: Container holding the internal RedHat CA files
    public: false
  - name: container-structure-test
    description: Container structure test image to test images structure
    mirror:
      $ref: /dependencies/image-mirrors/gcr.io/gcp-runtimes/container-structure-test.yml
    public: true
  - name: user-validator
    description: Image containing the user-validator
    public: true

gcrRepos:
- project:
    $ref: /dependencies/gcp/app-sre.yml
  items:
  - name: qontract-api
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/qontract-api.yml
  - name: qontract-validator
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/qontract-validator.yml
  - name: qontract-server
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/qontract-server.yml
  - name: qontract-reconcile
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/qontract-reconcile.yml
  - name: qontract-schemas
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/qontract-schemas.yml
  - name: manifest-bouncer
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/app-sre/manifest-bouncer.yml
  - name: saasherder
    description: ''
    public: true
    mirror:
      $ref: /dependencies/image-mirrors/quay.io/openshiftio/saasherder.yml

codeComponents:
- name: app-interface
  resource: upstream
  url: https://gitlab.cee.redhat.com/service/app-interface
  showInReviewQueue: true
  gitlabHousekeeping:
    enabled: true
    rebase: true
    limit: 2
    enable_closing: true
    days_interval: 7
    pipeline_timeout: 60
    labels_allowed:
    - role:
        $ref: /teams/app-sre/roles/app-sre.yml
    - role:
        $ref: /dependencies/gitlab/roles/crc-ic-member.yml
  jira:
    $ref: /dependencies/jira/issues-redhat-com.yaml
- name: app-interface-output
  resource: upstream
  url: https://gitlab.cee.redhat.com/service/app-interface-output
- name: container-images-public
  resource: upstream
  url: https://github.com/app-sre/container-images
- name: qontract-server
  resource: upstream
  url: https://github.com/app-sre/qontract-server
- name: qontract-reconcile
  resource: upstream
  url: https://github.com/app-sre/qontract-reconcile
- name: qontract-schemas
  resource: upstream
  url: https://github.com/app-sre/qontract-schemas
- name: qontract-validator
  resource: upstream
  url: https://github.com/app-sre/qontract-validator
- name: qontract-api
  resource: upstream
  url: https://gitlab.cee.redhat.com/service/qontract-api
- name: container-images-private
  resource: upstream
  url: https://gitlab.cee.redhat.com/app-sre/container-images
- name: qenerate
  resource: upstream
  url: https://github.com/app-sre/qenerate
- name: qontract-development-cli
  resource: upstream
  url: https://github.com/app-sre/qontract-development-cli
- name: skupper-prometheus-collector
  resource: upstream
  url: https://github.com/app-sre/skupper-prometheus-collector
