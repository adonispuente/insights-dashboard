---
$schema: /app-sre/slo-document-1.yml

labels:
  service: app-interface

name: app-interface

namespaces:
- $ref: /services/app-interface/namespaces/app-interface-production.yml

slos:
- name: Reconciliation time of app-interface integrations
  dashboard: https://grafana.app-sre.devshift.net/d/Integrations/integrations?orgId=1
  SLIType: latency
  SLISpecification: Proportion of time elapsed from app-interface merge to cluster modifying operations under 20 minutes
  SLOTarget: 0.95
  SLOTargetUnit: percent_0_1
  SLOParameters:
    window: 28d
  SLODetails: https://gitlab.cee.redhat.com/service/app-interface/-/tree/master/docs/app-interface/slos/reconciliation-of-app-interface-integrations.md
  expr: |
    sum(rate(qontract_reconcile_function_elapsed_seconds_since_bundle_commit_bucket{le="1200.0",name=~"reconcile\\.utils\\.oc\\.OC[^.]*\\.(apply|replace|delete|create)",integration!~"terraform-resources|sql-query"}[{{window}}]))
    /
    sum(rate(qontract_reconcile_function_elapsed_seconds_since_bundle_commit_count{name=~"reconcile\\.utils\\.oc\\.OC[^.]*\\.(apply|replace|delete|create)",integration!~"terraform-resources|sql-query"}[{{window}}]))
  prometheusRules: /observability/prometheusrules/qontract-reconcile-time-to-reconcile-slo.prometheusrules.yaml
