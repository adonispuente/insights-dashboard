---
$schema: /app-sre/saas-file-2.yml

labels:
  service: hacbs-kcp-syncer

name: saas-hacbs-kcp-syncer
description: 'SaaS tracking file for the HACBS kcp-syncer'

app:
  $ref: /services/hacbs/kcp-syncer/app.yml

pipelinesProvider:
  $ref: /services/hacbs/compute/pipelines/tekton-hacbs-compute-pipelines-appsrep05ue1.yml

imagePatterns:
# TODO - eventually replace this with a build of the kcp syncer produced by
# HACBS, hosted on quay.io
#- ghcr.io/kcp-dev/kcp/syncer
- quay.io/rbean/kcp-syncer

slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: hacbs-alerts

managedResourceTypes:
- Deployment
- ServiceAccount
- ClusterRole
- ClusterRoleBinding

resourceTemplates:
- name: kcp-syncer
  url: https://github.com/redhat-appstudio/workload-cluster-templates
  path: /openshift/kcp-syncer.yaml
  targets:
  - namespace:
      $ref: /services/hacbs/kcp-syncer/namespaces/hacbs-kcp-syncer.yml
    ref: main
    promotion:
      publish:
      - hacbs-alerts
    parameters:
      NAME: hacbs-kcp-syncer
      NAMESPACE: hacbs-kcp-syncer
      SYNC_TARGET_NAME: hacbss02ue1
      SYNC_TARGET_UID: 92bc1b07-bb19-4e32-bda8-c1061e88746a
      KCP_WORKSPACE: root:users:im:ld:rh-sso-ralphjbean
      KCP_URL: https://kcp-stable.apps.kcp-internal-1.52p3.p1.openshiftapps.com:443
      # Eventually, replace this with a prod image built by HACBS
      IMAGE: quay.io/rbean/kcp-syncer:release-0.9
      #IMAGE: ghcr.io/kcp-dev/kcp/syncer:release-0.9
