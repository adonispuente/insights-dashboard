---
$schema: /app-sre/saas-file-2.yml
labels:
  service: uhc
name: saas-ocm-api-tests
description: SaaS tracking file for OCM API Tests
app:
  $ref: /services/ocm/ams/app.yml
pipelinesProvider:
  $ref: /services/ocm/pipelines/tekton.ocm-pipelines.appsrep05ue1.yaml
deployResources:
  requests:
    cpu: 600m
    memory: 2000Mi
  limits:
    cpu: 1200m
    memory: 2000Mi
slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: team-uhc-info
managedResourceTypes:
  - Deployment
  - Service
  - Role
  - RoleBinding
imagePatterns:
  - quay.io/app-sre/ocm-api-tests
  - quay.io/centos/centos
authentication:
  image:
    path: app-sre/quay/app-sre-pull
    field: all
resourceTemplates:
  - name: api-tests
    url: https://gitlab.cee.redhat.com/service/api-tests
    path: /templates/service-template.yml
    parameters:
      DEPLOYMENT_NAME: ocm-api-tests-int
      ENVIRONMENT: production
      IMAGE_REGISTRY: quay.io
      IMAGE_REPOSITORY: app-sre/ocm-api-tests
      JWKS_URL: https://api.openshift.com/.well-known/jwks.json
      OCM_URL: https://api.integration.openshift.com
    targets:
      - namespace:
          $ref: /services/ocm/namespaces/uhc-integration.yml
        ref: 80118b1accd62435d30635f194c21ed503a96e30
        promotion:
          publish:
            - ocm-apitests-deployed-int
        parameters:
          UHC_TOKEN_URL: ${SSO_BASE_URL}/protocol/openid-connect/token
          ENABLE_JWT: false
  - name: api-tests-gatewatch
    url: https://gitlab.cee.redhat.com/service/api-tests
    path: /templates/gatewatch-template.yml
    parameters:
      IMAGE_REGISTRY: quay.io
      IMAGE_REPOSITORY: app-sre/ocm-api-tests
      OCM_URL: https://api.integration.openshift.com
    targets:
      - namespace:
          $ref: /services/ocm/namespaces/uhc-integration.yml
        ref: f94161ce9a167d8777d5a9696539dcfb1aee980e
        promotion:
          publish:
            - ocm-apitests-gatewatch-deployed-int
        parameters:
          NAMESPACE: uhc-integration
      - namespace:
          $ref: /services/ocm/namespaces/uhc-stage.yml
        ref: 80118b1accd62435d30635f194c21ed503a96e30
        promotion:
          publish:
            - ocm-apitests-gatewatch-deployed-stage
        parameters:
          NAMESPACE: uhc-stage
      - namespace:
          $ref: /services/ocm/namespaces/uhc-production.yml
        ref: 80118b1accd62435d30635f194c21ed503a96e30
        promotion:
          publish:
            - ocm-apitests-gatewatch-deployed-prod
        parameters:
          NAMESPACE: uhc-production
