---
$schema: /app-sre/saas-file-2.yml
labels:
  service: skupper-network-monitoring

name: saas-skupper-network-monitoring
description: SaaS file for Skupper Network Monitoring Components

app:
  $ref: /services/skupper-network-monitoring/app.yml

pipelinesProvider:
  $ref: /services/skupper-network-monitoring/pipelines/tekton.skupper-network-monitoring-pipelines.appsrep05ue1.yml

slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: sd-app-sre-info

authentication:
  image:
    path: app-sre/quay/app-sre-pull
    field: all

managedResourceTypes:
- Deployment
- Service
- ServiceAccount
- ConfigMap
- Secret

imagePatterns:
- quay.io/app-sre/skupper-prometheus-collector
- quay.io/app-sre/x509-certificate-exporter

resourceTemplates:
- name: x509-certificate-exporter
  url: https://github.com/app-sre/x509-certificate-exporter
  path: /openshift/template.yml
  targets:
  # stage
  - provider: dynamic
    namespaceSelector:
      jsonPathSelectors:
        include:
        - namespace[?@.environment.labels.type="stage" & @.skupperSite]
        exclude:
        - namespace[?@.skupperSite.delete=true]
    ref: main
    parameters:
      IMAGE_VERSION: 3.6.0
  # production
  - provider: dynamic
    namespaceSelector:
      jsonPathSelectors:
        include:
        - namespace[?@.skupperSite]
        exclude:
        - namespace[?@.environment.labels.type="stage"]
        - namespace[?@.skupperSite.delete=true]
    ref: c151758c8237670d43fee7c89a9352412266e234
    parameters:
      IMAGE_VERSION: 3.6.0
# TODO grafana dashboards!
