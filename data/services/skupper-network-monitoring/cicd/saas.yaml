---
$schema: /app-sre/saas-file-2.yml
labels:
  service: skupper-network-monitoring

name: saas-skupper-network-monitoring
description: SaaS file for Skupper Network Monitoring Components

app:
  $ref: /services/skupper-network-monitoring/app.yml

pipelinesProvider:
  $ref: /services/skupper-network-monitoring/pipelines/tekton.skupper-network-monitoring-pipelines.appsrep05ue1.yml

slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: sd-app-sre-info

managedResourceTypes:
- Deployment
- Service
- ServiceAccount
- ConfigMap

imagePatterns:
- quay.io/app-sre/skupper-prometheus-collector
- quay.io/app-sre/x509-certificate-exporter

resourceTemplates:
- name: x509-certificate-exporter
  url: https://github.com/app-sre/x509-certificate-exporter
  path: /openshift/template.yml
  targets:
  # stage
  - provider: dynamic
    namespaceSelector:
      jsonPathSelectors:
        include:
        - namespace[?@.environment.labels.type="stage" & @.skupperSite]
        exclude:
        - namespace[?@.skupperSite.delete=true]
    ref: main
    image:
      org:
        $ref: /dependencies/quay/app-sre.yml
      name: x509-certificate-exporter
    parameters:
      IMAGE_VERSION: 3.6.0
# production
# - provider: dynamic
#   namespaceSelector:
#     jsonPathSelectors:
#       include:
#       - namespace[?@.skupperSite]
#       exclude:
#       - namespace[?@.environment.labels.type="stage"]
#       - namespace[?@.skupperSite.delete=true]
#   ref: todo
# TODO grafana dashboards!
