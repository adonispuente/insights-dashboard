---
$schema: /app-interface/app-interface-sql-query-1.yml
name: 2021-09-30-get-db-storage
labels: {}
namespace:
  $ref: /services/insights/malware-detection/namespaces/malware-detection-prod.yml
identifier: malware-detection-prod
output: stdout
query: |
  SELECT nspname || '.' || relname AS "relation",
      pg_size_pretty(pg_relation_size(C.oid)) AS "size"
    FROM pg_class C
    LEFT JOIN pg_namespace N ON (N.oid = C.relnamespace)
    WHERE nspname NOT IN ('pg_catalog', 'information_schema')
    ORDER BY pg_relation_size(C.oid) DESC
    LIMIT 20;
