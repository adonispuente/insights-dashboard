---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2022-03-10-vulnerability-dashboard-cte
namespace:
  $ref: /services/insights/vulnerability/namespaces/vulnerability-engine-prod.yml
identifier: vulnerability-engine
output: stdout
query: |
  EXPLAIN ANALYZE SELECT "t1"."system_id", "t1"."cve_id", "t1"."rule_id"
    FROM "system_vulnerabilities_active" AS "t1" INNER JOIN
         "system_platform" AS "t2" ON ((((((("t1"."system_id" = "t2"."id") AND
                                            ("t2"."rh_account_id" = 3552)) AND
                                            ("t2"."when_deleted" IS NULL)) AND
                                            ("t2"."stale" = FALSE)) AND
                                            ("t2"."opt_out" = FALSE)) AND
                                            (("t2"."last_evaluation" IS NOT NULL) OR ("t2"."advisor_evaluated" IS NOT NULL))) AND
                                            (COALESCE("t2"."host_type", 'null') != 'edge'))
    WHERE (("t1"."rh_account_id" = 3552) AND
           ("t1"."mitigation_reason" IS NULL));
