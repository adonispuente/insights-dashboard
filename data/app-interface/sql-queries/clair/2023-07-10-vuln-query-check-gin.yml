---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: clair-matcher-vuln-query-check-gin-2
namespace:
  $ref: /services/clair/namespaces/production.yml
identifier: clair-matcher
output: stdout
query:  |
  EXPLAIN ANALYSE
  SELECT 
    "id", 
    "name", 
    "description", 
    "issued", 
    "links", 
    "severity", 
    "normalized_severity", 
    "package_name", 
    "package_version", 
    "package_module", 
    "package_arch", 
    "package_kind", 
    "dist_id", 
    "dist_name", 
    "dist_version", 
    "dist_version_code_name", 
    "dist_version_id", 
    "dist_arch", 
    "dist_cpe", 
    "dist_pretty_name", 
    "arch_operation", 
    "repo_name", 
    "repo_key", 
    "repo_uri", 
    "fixed_in_version", 
    "updater" 
  FROM 
    "latest_vuln" 
  WHERE 
    (
      (
        (
          "package_name" = 'github.com/gin-gonic/gin'
        ) 
        AND ("package_kind" = 'binary')
      ) 
      AND ("repo_name" = 'go') 
      AND (
        ("version_kind" = 'semver') 
        AND vulnerable_range @> '{0,1,9,0,0,0,0,0,0,0}'::int[]
      )
    );

