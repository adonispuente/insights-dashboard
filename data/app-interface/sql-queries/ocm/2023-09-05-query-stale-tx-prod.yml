---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2023-09-05-query-stale-tx-prod
namespace:
  $ref: /services/ocm/namespaces/uhc-production.yml
identifier: clusters-service-production
output: stdout
queries:
  - select pid, usename, pg_blocking_pids(pid) as blocked_by, query as blocked_query from pg_stat_activity where cardinality(pg_blocking_pids(pid)) > 0;
  - select pid,usename,backend_start,query from pg_stat_activity where (state = 'idle in transaction') and xact_start is not null;
