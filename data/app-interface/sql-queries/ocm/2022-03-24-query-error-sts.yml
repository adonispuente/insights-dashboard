---
$schema: /app-interface/app-interface-sql-query-1.yml
labels: {}
name: 2022-03-24-query-error-sts
namespace:
  $ref: /services/ocm/namespaces/uhc-production.yml
identifier: clusters-service-production
output: stdout
queries:
  - select count(id) from clusters where creation_timestamp > '2022-03-17T00:00:00Z' AND creation_timestamp <= '2022-03-24T00:00:00Z' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-03-17T00:00:00Z' AND creation_timestamp <= '2022-03-24T00:00:00Z' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-03-10T00:00:00Z' AND creation_timestamp <= '2022-03-17T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-03-10T00:00:00Z' AND creation_timestamp <= '2022-03-17T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-03-03T00:00:00Z' AND creation_timestamp <= '2022-03-10T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-03-03T00:00:00Z' AND creation_timestamp <= '2022-03-10T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-02-24T00:00:00Z' AND creation_timestamp <= '2022-03-03T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-02-24T00:00:00Z' AND creation_timestamp <= '2022-03-03T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-02-17T00:00:00Z' AND creation_timestamp <= '2022-02-24T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-02-17T00:00:00Z' AND creation_timestamp <= '2022-02-24T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-02-10T00:00:00Z' AND creation_timestamp <= '2022-02-17T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-02-10T00:00:00Z' AND creation_timestamp <= '2022-02-17T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-02-03T00:00:00Z' AND creation_timestamp <= '2022-02-10T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-02-03T00:00:00Z' AND creation_timestamp <= '2022-02-10T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-01-27T00:00:00Z' AND creation_timestamp <= '2022-02-03T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-01-27T00:00:00Z' AND creation_timestamp <= '2022-02-03T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-01-20T00:00:00Z' AND creation_timestamp <= '2022-01-27T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-01-20T00:00:00Z' AND creation_timestamp <= '2022-01-27T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

  - select count(id) from clusters where creation_timestamp > '2022-01-13T00:00:00Z' AND creation_timestamp <= '2022-01-20T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from deleted_clusters where creation_timestamp > '2022-01-13T00:00:00Z' AND creation_timestamp <= '2022-01-20T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  
  - select count(id) from deleted_clusters where creation_timestamp > '2022-01-06T00:00:00Z' AND creation_timestamp <= '2022-01-13T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';
  - select count(id) from clusters where state='error' AND creation_timestamp > '2022-01-06T00:00:00Z' AND creation_timestamp <= '2022-01-13T00:00:00Z' AND managed='t' AND aws_sts_role_arn is not null AND aws_sts_role_arn != '';

