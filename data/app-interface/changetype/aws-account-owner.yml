---
$schema: /app-interface/change-type-1.yml

labels: {}

name: aws-account-owner
description: |
  Allows actions in an AWS account

priority: low

contextType: datafile
contextSchema: /aws/account-1.yml

inherit:
- $ref: /app-interface/changetype/aws-deletion-approvals.yml
- $ref: /app-interface/changetype/aws-password-reset.yml

changes:
- provider: jsonPath
  jsonPathSelectors:
  - supportedDeploymentRegions
  - disable
- provider: jsonPath
  changeSchema: /openshift/namespace-1.yml
  jsonPathSelectors:
  - externalResources[?(@.provisioner.'$ref'=='{{ ctx_file_path }}')]
  context:
    selector: externalResources[*].provisioner.'$ref'
- provider: jsonPath
  changeSchema: /aws/group-1.yml
  jsonPathSelectors:
  - $
  context:
    selector: account.'$ref'
- provider: jsonPath
  changeSchema: /aws/group-1.yml
  jsonPathSelectors:
  - $
  context:
    selector: account.'$ref'
    when: added
- provider: jsonPath
  changeSchema: /aws/policy-1.yml
  jsonPathSelectors:
  - $
  context:
    selector: account.'$ref'
- provider: jsonPath
  changeSchema: /aws/policy-1.yml
  jsonPathSelectors:
  - $
  context:
    selector: account.'$ref'
    when: added
