---
$schema: /app-interface/change-type-1.yml

labels: {}

name: elasticache-maintainer
description: |
  Allow updates on AWS ElastiCache in namespaces.

priority: high

contextType: datafile
contextSchema: /openshift/namespace-1.yml

changes:
- provider: jsonPath
  jsonPathSelectors:
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].overrides.apply_immediately
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].overrides.deletion_protection
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].overrides.engine_version
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].overrides.maintenance_window
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].overrides.parameter_group_name
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].annotations
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].event_notifications
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].output_resource_name
  - externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].parameter_group
- provider: change-type
  changeTypes:
  - $ref: /app-interface/changetype/elasticache-defaults-maintainer.yml
  context:
    where: backrefs
    selector: externalResources[?(@.provider=="aws")].resources[?(@.provider=="elasticache")].defaults
