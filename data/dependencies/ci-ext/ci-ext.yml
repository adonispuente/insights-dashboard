---
$schema: /dependencies/jenkins-instance-1.yml

labels:
  service: ci-ext

name: ci-ext
description: External CI instance for the App SRE managed services

serverUrl: https://ci.ext.devshift.net
token:
  path: app-sre/ci-ext/jjb-ini
  field: jjb-ini-toml

workerFleets:
- identifier: ci-ext-jenkins-worker-app-sre
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: app-interface app-sre insights
  numExecutors: 4
- identifier: ci-ext-jenkins-worker-service-development
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: sd-service-development sd-uhc
  numExecutors: 2
- identifier: ci-ext-jenkins-worker-hive
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: aws-account-operator backplane certman-operator deadmanssnitch-operator hive pagerduty-operator sd-sre srep-operators
  numExecutors: 2
- identifier: ci-ext-jenkins-worker-quarkus
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: quarkus
  numExecutors: 2
- identifier: ci-ext-jenkins-worker-toolchain
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: toolchain
  numExecutors: 2
- identifier: ci-ext-jenkins-worker-codeready-analytics
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: codeready-analytics
  numExecutors: 2
- identifier: ci-ext-jenkins-worker-rhel8
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: rhel8
  numExecutors: 2

buildsCleanupRules:
  - name: 'build-'
    keep_hours: 744
  - name: '-pr-check'
    keep_hours: 168
  - name: ''
    keep_hours: 360
