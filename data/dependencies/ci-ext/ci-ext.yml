---
$schema: /dependencies/jenkins-instance-1.yml

labels:
  service: ci-ext

name: ci-ext
description: External CI instance for the App SRE managed services

serverUrl: https://ci.ext.devshift.net
token:
  path: app-sre/ci-ext/jjb-ini
  field: jjb-ini-toml

workerFleets:
- identifier: ci-ext-jenkins-worker-app-sre
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: app-interface app-sre insights backplane srep-operators quarkus
  numExecutors: 3
  maxTotalUses: 100
- identifier: ci-ext-jenkins-worker-codeready-analytics
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: codeready-analytics
  numExecutors: 2
  maxTotalUses: 100
- identifier: ci-ext-jenkins-worker-rhel8
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins-slaves
  fsRoot: /var/lib/jenkins
  labelString: rhel8
  numExecutors: 2
  maxTotalUses: 100

buildsCleanupRules:
  - name: 'build-'
    keep_hours: 744
  - name: '-pr-check'
    keep_hours: 168
  - name: ''
    keep_hours: 360
