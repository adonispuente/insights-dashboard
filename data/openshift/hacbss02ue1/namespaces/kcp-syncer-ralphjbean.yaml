---
$schema: /openshift/namespace-1.yml

labels:
  workload.kcp.io/logical-cluster: root_users_im_ld_rh-sso-ralphjbean
  workload.kcp.io/sync-target: hacbss02ue1

name: kcp-syncer-ralphjbean
description: hacbss02ue1 kcp-syncer-ralphjbean namespace. This is where the kcp-syncer runs that syncs to Ralph's personal namespace - for PoC.

cluster:
  $ref: /openshift/hacbss02ue1/cluster.yml

app:
  $ref: /services/app-sre/app.yml

environment:
  $ref: /products/app-sre/environments/stage.yml

managedResourceTypes:
- Deployment
- ServiceAccount
- Secret
- ClusterRole
- ClusterRoleBinding

openshiftResources:

- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-deployment.j2
  variables:
    # Generated from the SyncTarget in kcp
    # $ kubectl kcp workload sync hacbss02ue1
    uuid: 92bc1b07-bb19-4e32-bda8-c1061e88746a
    workspace: root:users:im:ld:rh-sso-ralphjbean

- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-secret.j2
  variables:
    kcp_url: https://kcp-stable.apps.kcp-internal-1.52p3.p1.openshiftapps.com:443
    # Used to look up the syncer token in vault
    team: hacbs

- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-service-account.j2
- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-service-account-token.j2
- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-cluster-role.j2
- provider: resource-template
  type: extracurlyjinja2
  path: /kcp/workload/kcp-syncer-cluster-role-binding.j2
