- name: VaultAuditOptions_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: _type
    fieldMap:
      file: VaultAuditOptionsFile_v1
  fields:
  - { name: _type, type: string, isRequired: true }

- name: VaultAuditOptionsFile_v1
  interface: VaultAuditOptions_v1
  fields:
  - { name: _type, type: string, isRequired: true }
  - { name: file_path, type: string, isRequired: true }
  - { name: log_raw, type: string, isRequired: true }
  - { name: hmac_accessor, type: string, isRequired: true }
  - { name: mode, type: string, isRequired: true }
  - { name: format, type: string, isRequired: true }
  - { name: prefix, type: string, isRequired: true }

- name: VaultAudit_v1
  fields:
  - { name: _path, type: string, isRequired: true }
  - { name: type, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: options, type: VaultAuditOptions_v1, isInterface: true, isRequired: true }

- name: VaultAuthConfig_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: _type
    fieldMap:
      github: VaultAuthConfigGithub_v1
  fields:
  - { name: _type, type: string, isRequired: true }

- name: VaultAuthConfigGithub_v1
  interface: VaultAuthConfig_v1
  fields:
  - { name: _type, type: string, isRequired: true }
  - { name: organization, type: string, isRequired: true }
  - { name: base_url, type: string, isRequired: true }
  - { name: max_ttl, type: string, isRequired: true }
  - { name: ttl, type: string, isRequired: true }

- name: VaultAuthSettings_v1
  fields:
  - { name: config, type: VaultAuthConfig_v1, isInterface: true, isRequired: true }

- name: VaultSecretEngineOptions_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: _type
    fieldMap:
      kv: VaultSecretEngineOptionsKV_v1
  fields:
  - { name: _type, type: string, isRequired: true }

- name: VaultSecretEngineOptionsKV_v1
  interface: VaultSecretEngineOptions_v1
  fields:
  - { name: _type, type: string, isRequired: true }
  - { name: version, type: string, isRequired: true }

- name: VaultSecretEngine_v1
  fields:
  - { name: _path, type: string, isRequired: true }
  - { name: type, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true}
  - { name: options, type: VaultSecretEngineOptions_v1, isInterface: true, isRequired: true }

- name: VaultRoleOptions_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: _type
    fieldMap:
      approle: VaultApproleOptions_v1
  fields:
  - { name: _type, type: string, isRequired: true }

- name: VaultApproleOptions_v1
  interface: VaultRoleOptions_v1
  fields:
  - { name: _type, type: string, isRequired: true }
  - { name: bind_secret_id, type: string, isRequired: true }
  - { name: local_secret_ids, type: string, isRequired: true }
  - { name: period, type: string, isRequired: true }
  - { name: secret_id_num_uses, type: string, isRequired: true }
  - { name: secret_id_ttl, type: string, isRequired: true }
  - { name: token_max_ttl, type: string, isRequired: true }
  - { name: token_num_uses, type: string, isRequired: true }
  - { name: token_ttl, type: string, isRequired: true }
  - { name: token_type, type: string, isRequired: true }
  - { name: bound_cidr_list, type: string, isList: true, isRequired: true }
  - { name: policies, type: string, isList: true, isRequired: true }
  - { name: secret_id_bound_cidrs, type: string, isList: true, isRequired: true }
  - { name: token_bound_cidrs, type: string, isList: true, isRequired: true }

- name: VaultRole_v1
  fields:
  - { name: name, type: string, isRequired: true }
  - { name: type, type: string, isRequired: true }
  - { name: mount, type: string, isRequired: true }
  - { name: options, type: VaultRoleOptions_v1, isInterface: true, isRequired: true }

- name: VaultPolicy_v1
  fields:
  - { name: name, type: string, isRequired: true }
  - { name: rules, type: string, isRequired: true }

- name: Resource_v1
  fields:
  - { name: path, type: string, isRequired: true}
  - { name: content, type: string, isRequired: true}
  - { name: sha256sum, type: string, isRequired: true}

- name: VaultSecret_v1
  fields:
  - { name: path, type: string, isRequired: true }
  - { name: field, type: string, isRequired: true }
  - { name: format, type: string }

- name: QuayOrg_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: managedTeams, type: string, isList: true, isRequired: true }
  - { name: automationToken, type: VaultSecret_v1 }

- name: Cluster_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string }
  - { name: serverUrl, type: string, isRequired: true }
  - { name: automationToken, type: VaultSecret_v1 }

- name: NamespaceOpenshiftResource_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: provider
    fieldMap:
      resource: NamespaceOpenshiftResourceResource_v1
      vault-secret: NamespaceOpenshiftResourceVaultSecret_v1
      route: NamespaceOpenshiftResourceRoute_v1
  fields:
  - { name: provider, type: string, isRequired: true }

- name: NamespaceOpenshiftResourceResource_v1
  interface: NamespaceOpenshiftResource_v1
  fields:
  - { name: provider, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }

- name: NamespaceOpenshiftResourceVaultSecret_v1
  interface: NamespaceOpenshiftResource_v1
  fields:
  - { name: provider, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: version, type: int, isRequired: true }
  - { name: name, type: string }
  - { name: labels, type: json }
  - { name: annotations, type: json }
  - { name: type, type: string }

- name: NamespaceOpenshiftResourceRoute_v1
  interface: NamespaceOpenshiftResource_v1
  fields:
  - { name: provider, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: vault_tls_secret_path, type: string }
  - { name: vault_tls_secret_version, type: int }

- name: Namespace_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: cluster, type: Cluster_v1, isRequired: true }
  - { name: managedRoles, type: string, isList: true}
  - { name: managedResourceTypes, type: string, isList: true}
  - { name: openshiftResources, type: NamespaceOpenshiftResource_v1, isList: true, isInterface: true}

- name: AppServiceOwner_v1
  fields:
  - { name: name, type: string, isRequired: true }
  - { name: email, type: string, isRequired: true }

- name: AppPerformanceParameters_v1
  fields:
  - { name: SLO, type: float, isRequired: true }
  - { name: SLA, type: float }
  - { name: statusPage, type: string }

- name: Dependency_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: statefulness, type: string, isRequired: true }
  - { name: opsModel, type: string, isRequired: true }
  - { name: statusPage, type: string }
  - { name: SLA, type: float, isRequired: true }
  - { name: dependencyFailureImpact, type: string, isRequired: true }

- name: AppQuayReposItems_v1
  fields:
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: public, type: boolean, isRequired: true }

- name: AppQuayRepos_v1
  fields:
  - { name: org, type: QuayOrg_v1, isRequired: true }
  - { name: items, type: AppQuayReposItems_v1, isRequired: true, isList: true }

- name: AppEscalationsEscalation_v1
  fields:
  - { name: labels, type: json }
  - { name: slackRecipients, type: string, isList: true }
  - { name: emailRecipients, type: string, isList: true }
  - { name: mattermostRecipients, type: string, isList: true }

- name: AppEscalations_v1
  fields:
  - { name: default, type: AppEscalationsEscalation_v1 }
  - { name: warning, type: AppEscalationsEscalation_v1 }
  - { name: critical, type: AppEscalationsEscalation_v1 }

- name: App_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: serviceDocs, type: string, isList: true }
  - { name: serviceOwner, type: AppServiceOwner_v1, isRequired: true }
  - { name: dependencies, type: Dependency_v1, isList: true }
  - { name: quayRepos, type: AppQuayRepos_v1, isList: true }
  - { name: escalations, type: AppEscalations_v1, isList: true }
  - { name: performanceParameters, type: AppPerformanceParameters_v1, isRequired: true }

- name: Permission_v1
  isInterface: true
  interfaceResolve:
    strategy: fieldMap
    field: service
    fieldMap:
      aws-analytics: PermissionAWSAnalytics_v1
      github-org: PermissionGithubOrg_v1
      github-org-team: PermissionGithubOrgTeam_v1
      openshift-rolebinding: PermissionOpenshiftRolebinding_v1
      quay-membership: PermissionQuayOrgTeam_v1
  fields:
  - { name: service, type: string, isRequired: true }

- name: PermissionAWSAnalytics_v1
  interface: Permission_v1
  fields:
  - { name: service, type: string, isRequired: true }

- name: PermissionGithubOrg_v1
  interface: Permission_v1
  fields:
  - { name: service, type: string, isRequired: true }
  - { name: org, type: string, isRequired: true }

- name: PermissionGithubOrgTeam_v1
  interface: Permission_v1
  fields:
  - { name: service, type: string, isRequired: true }
  - { name: org, type: string, isRequired: true }
  - { name: team, type: string, isRequired: true }

- name: VaultPolicyMapping_v1
  fields:
  - { name: github_team, type: PermissionGithubOrgTeam_v1, isRequired: true }
  - { name: policies, type: VaultPolicy_v1, isList: true, isRequired: true }

- name: VaultAuth_v1
  fields:
  - { name: _path, type: string, isRequired: true }
  - { name: type, type: string, isRequired: true }
  - { name: description, type: string, isRequired: true }
  - { name: settings, type: VaultAuthSettings_v1 }
  - { name: policy_mappings, type: VaultPolicyMapping_v1, isList: true }

- name: PermissionOpenshiftRolebinding_v1
  interface: Permission_v1
  fields:
  - { name: service, type: string, isRequired: true }
  - { name: cluster, type: string, isRequired: true }
  - { name: namespace, type: string, isRequired: true }
  - { name: role, type: string, isRequired: true }

- name: PermissionQuayOrgTeam_v1
  interface: Permission_v1
  fields:
  - { name: service, type: string, isRequired: true }
  - { name: org, type: string, isRequired: true }
  - { name: team, type: string, isRequired: true }

- name: User_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: redhat_username, type: string, isRequired: true }
  - { name: github_username, type: string, isRequired: true }
  - { name: quay_username, type: string }

- name: Bot_v1
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string }
  - { name: github_username, type: string }
  - { name: quay_username, type: string }
  - { name: owner, type: User_v1 }

- name: Role_v1
  datafile: /access/role-1.yml
  fields:
  - { name: schema, type: string, isRequired: true }
  - { name: path, type: string, isRequired: true }
  - { name: labels, type: json }
  - { name: name, type: string, isRequired: true }
  - { name: description, type: string }
  - { name: permissions, type: Permission_v1, isList: true, isInterface: true }
  - name: users
    type: User_v1
    isList: true
    synthetic:
      schema: /access/user-1.yml
      subAttr: roles
  - name: bots
    type: Bot_v1
    isList: true
    synthetic:
      schema: /access/bot-1.yml
      subAttr: roles

- name: Query
  fields:
  - { name: users_v1, type: User_v1, isList: true, datafileSchema: /access/user-1.yml }
  - { name: bots_v1, type: Bot_v1, isList: true, datafileSchema: /access/bot-1.yml }
  - { name: roles_v1, type: Role_v1, isList: true, datafileSchema: /access/role-1.yml }
  - { name: clusters_v1, type: Cluster_v1, isList: true, datafileSchema: /openshift/cluster-1.yml }
  - { name: namespaces_v1, type: Namespace_v1, isList: true, datafileSchema: /openshift/namespace-1.yml }
  - { name: quay_orgs_v1, type: QuayOrg_v1, isList: true, datafileSchema: /dependencies/quay-org-1.yml }
  - { name: apps_v1, type: App_v1, isList: true, datafileSchema: /app-sre/app-1.yml }
  - { name: resources_v1, type: Resource_v1, isResource: true, isRequired: true, isList: true }
  - { name: vault_audit_backends_v1, type: VaultAudit_v1, isList: true, datafileSchema: /vault-config/audit-1.yml }
  - { name: vault_auth_backends_v1, type: VaultAuth_v1, isList: true, datafileSchema: /vault-config/auth-1.yml }
  - { name: vault_secret_engines_v1, type: VaultSecretEngine_v1, isList: true, datafileSchema: /vault-config/secret-engine-1.yml }
  - { name: vault_roles_v1, type: VaultRole_v1, isList: true, datafileSchema: /vault-config/role-1.yml }
  - { name: vault_policies_v1, type: VaultPolicy_v1, isList: true, datafileSchema: /vault-config/policy-1.yml }
  - { name: dependencies_v1, type: Dependency_v1, isList: true, datafileSchema: /dependencies/dependency-1.yml }
