apiVersion: v1
kind: Secret
metadata:
  name: {{{ name }}}
  annotations:
    qontract.ignore_reconcile_time: "true"
    qontract.recycle: "true"
data:
  config.yaml: |
    {{% b64encode %}}
    authentication:
      url: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-service-tool-config', 'authentication.url', '{{ vault_secret_version }}') }}}
      realm: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-service-tool-config', 'authentication.realm', '{{ vault_secret_version }}') }}}
      clientid: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-service-tool-config', 'authentication.clientid', '{{ vault_secret_version }}') }}}
      role: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-service-tool-config', 'authentication.role', '{{ vault_secret_version }}') }}}
    DB_URI: 'mysql+pymysql://{{{ vault('app-sre/integrations-output/terraform-resources/quays02ue1/quay/quayio-stage-57-py3-rds', 'db.user') }}}:{{{ vault('app-sre/integrations-output/terraform-resources/quays02ue1/quay/quayio-stage-57-py3-rds', 'db.password') }}}@{{{ vault('app-sre/integrations-output/terraform-resources/quays02ue1/quay/quayio-stage-57-py3-rds', 'db.host') }}}/{{{ vault('app-sre/integrations-output/terraform-resources/quays02ue1/quay/quayio-stage-57-py3-rds', 'db.name') }}}'
    is_local: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-service-tool-config', 'is_local', '{{ vault_secret_version }}') }}}
    DATABASE_SECRET_KEY: {{{ vault('app-interface/quayio-stage/quayio-stage/quay-additional-config', 'DATABASE_SECRET_KEY', 1) }}}
    {{% endb64encode %}}
