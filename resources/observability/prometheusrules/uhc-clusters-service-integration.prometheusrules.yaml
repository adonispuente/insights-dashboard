---
$schema: /openshift/prometheus-rule-1.yml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    prometheus: app-sre
    role: alert-rules
  name: uhc-clusters-service-integration
spec:
  groups:
  - name: uhc-clusters-service-integration
    rules:

    - alert: OCMClustersMgmtCrashing - integration
      annotations:
        message: OCM integration clusters management service container '{{ $labels.container }}' of pod '{{ $labels.pod }}' is crashing
        runbook: https://gitlab.cee.redhat.com/service/app-interface/tree/master/docs/uhc/sop
      expr: |
        sum(increase(kube_pod_container_status_restarts_total{namespace="uhc-integration",pod=~"^clusters-service-.*$"}[10m]))
        by (pod,container)
        >= 2
      for: 1m
      labels:
        service: uhc-clusters-service
        severity: medium
        email: service-development-a
