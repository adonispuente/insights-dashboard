apiVersion: v1
kind: Secret
metadata:
  name: redis-url
  annotations:
    qontract.recycle: "true"
type: Opaque
stringData:
  redis.url: "rediss://:{{ vault('{{ secret }}', 'db.auth_token') }}@{{ vault('{{ secret }}', 'db.endpoint') }}:{{ vault('{{ secret }}', 'db.port') }}"
# temporary solution until solution in design doc
# https://gitlab.cee.redhat.com/service/app-interface/-/blob/master/docs/app-sre/design-docs/terraform-output-secret-format.md
# has been implemented
