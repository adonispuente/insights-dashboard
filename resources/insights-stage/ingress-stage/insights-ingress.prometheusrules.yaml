---
$schema: /openshift/prometheus-rule-1.yml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: insights-stage
  labels:
    prometheus: app-sre
    role: alert-rules
spec:
  groups:
  - name: insights-host-inventory
    rules:
      - alert: App-insights-puptoo-In-platform-prod-Absent
        expr: absent(up{app="insights-puptoo", kubernetes_namespace="ingress-stage"})
        for: 5m
        labels:
          alert_tool: pagerduty
          alert_team: insights_sre_alerts
          env: stage
        annotations:
          dashboard: "https://metrics.1b13.insights.openshiftapps.com/d/tFpOoKjZz/ingress-and-puptoo-messages"
          link_url: "https://console-openshift-console.apps.crc-stg-01.o4v9.p1.openshiftapps.com/k8s/ns/ingress-stage/deployments"
          message: "Alert name: App-insights-puptoo-In-platform-prod-Absent from insights-puptoo in ingress-stage"
          runbook: "https://url.corp.redhat.com/2d6c205"
      - alert: App-upload-service-In-platform-prod-Absent
        expr: absent(up{app="upload-service", kubernetes_namespace="ingress-stage"})
        for: 5m
        labels:
          alert_tool: pagerduty
          alert_team: insights_sre_alerts
          env: stage
        annotations:
          summary: 'Metrics for upload-service in PROD are absent'
          description: '[https://url.corp.redhat.com/d16a17f](There have been no metrics scrapes reported for upload-service in PROD)'

          dashboard: "https://metrics.1b13.insights.openshiftapps.com/d/Av2gccIZk/ingress-dashboard"
          link_url: "https://console-openshift-console.apps.crc-stg-01.o4v9.p1.openshiftapps.com/k8s/ns/ingress-stage/deployments"
          message: "Alert name: App-upload-service-In-platform-prod-Absent from upload-service in ingress-stage"
          runbook: "https://url.corp.redhat.com/d16a17f"
