apiVersion: v1
kind: Secret
metadata:
  name: {{{ name }}}
  annotations:
    qontract.ignore_reconcile_time: "true"
    qontract.recycle: "true"
data:
  config.yaml: |
    {{% b64encode %}}
    authentication:
      url: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-service-tool-config', 'authentication.url', '{{ vault_secret_version }}') }}}
      realm: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-service-tool-config', 'authentication.realm', '{{ vault_secret_version }}') }}}
      clientid: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-service-tool-config', 'authentication.clientid', '{{ vault_secret_version }}') }}}
      role: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-service-tool-config', 'authentication.role', '{{ vault_secret_version }}') }}}
    DB_URI: mysql+pymysql://{{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-additional-config', 'db.user', '{{ additional_config_vault_secret_version }}') }}}:{{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-additional-config', 'db.password', '{{ additional_config_vault_secret_version }}') }}}@{{{ vault('app-sre/integrations-output/terraform-resources/quayp05ue1/quay/quayio-production-py3-rds', 'db.host') }}}/{{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-additional-config', 'db.name', '{{ additional_config_vault_secret_version }}') }}}
    DATABASE_SECRET_KEY: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-additional-config', 'DATABASE_SECRET_KEY', '{{ additional_config_vault_secret_version }}') }}}
    is_local: {{{ vault('app-interface/quayio-prod-us-east-1/quay/quay-service-tool-config', 'is_local', '{{ vault_secret_version }}') }}}
    {{% endb64encode %}}
