apiVersion: v1
kind: Secret
metadata:
  name: grafana-datasources
data:
  datasources.yaml:
    {{% b64encode %}}
        {
            "apiVersion": 1,
            "datasources": [
                {
                    "name": "recent",
                    "type": "prometheus",
                    "typeLogoUrl": "",
                    "access": "proxy",
                    "url": "https://infogw-proxy.api.openshift.com/",
                    "basicAuth": false,
                    "isDefault": true,
                    "withCredentials": false,
                    "jsonData": {
                        "tlsSkipVerify": true,
                        "httpHeaderName1": "Authorization"
                    },
                    "secureJsonData": {
                        "httpHeaderValue1": "Bearer {{{ vault('app-sre/integrations-output/openshift-serviceaccount-tokens/datahub-psi/dh-prod-prometheus-lts/telemeter-prod-01-telemeter-production-datahub-prometheus-access', 'token') }}}"
                    }
                },
                {
                    "name": "recent-stage",
                    "type": "prometheus",
                    "typeLogoUrl": "",
                    "access": "proxy",
                    "url": "https://infogw-proxy.api.stage.openshift.com/",
                    "basicAuth": false,
                    "withCredentials": false,
                    "jsonData": {
                        "tlsSkipVerify": true,
                        "httpHeaderName1": "Authorization"
                    },
                    "secureJsonData": {
                        "httpHeaderValue1": "Bearer {{{ vault('app-sre/integrations-output/openshift-serviceaccount-tokens/datahub-psi/dh-stage-prometheus-lts/app-sre-stage-01-telemeter-stage-datahub-prometheus-access', 'token') }}}"
                    }
                },    
                {
                    "name": "historical",
                    "type": "prometheus",
                    "typeLogoUrl": "",
                    "access": "proxy",
                    "url": "https://telemeter-lts.datahub.redhat.com",
                    "basicAuth": false,
                    "withCredentials": false,
                    "jsonData": {
                        "tlsSkipVerify": true,
                        "httpHeaderName1": "Authorization"
                    },
                    "secureJsonData": {
                        "httpHeaderValue1": "Bearer {{{ vault('app-sre/creds/kube-configs/datahub-psi', 'token') }}}"
                    }
                },
                {
                    "name": "historical-stage",
                    "type": "prometheus",
                    "typeLogoUrl": "",
                    "access": "proxy",
                    "url": "https://prometheus-dh-stage-prometheus-lts.cloud.datahub.psi.redhat.com",
                    "basicAuth": false,
                    "withCredentials": false,
                    "jsonData": {
                        "tlsSkipVerify": true,
                        "httpHeaderName1": "Authorization"
                    },
                    "secureJsonData": {
                        "httpHeaderValue1": "Bearer {{{ vault('app-sre/creds/kube-configs/datahub-psi', 'token') }}}"
                    }
                }
            ]
        }
    {{% endb64encode %}}
