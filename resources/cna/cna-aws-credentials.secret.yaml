apiVersion: v1
kind: Secret
metadata:
  name: cna-aws-credentials
  annotations:
    qontract.recycle: "true"
type: Opaque
stringData:
  credentials: |
    [sa-sts]
    role_arn = {{ vault('app-sre/integrations-output/terraform-resources/' ~ resource.namespace.cluster.name ~ '/' ~ resource.namespace.name ~ '/cna-sts-iam', 'role_arn') }}
    web_identity_token_file = /var/run/secrets/openshift/serviceaccount/token
    role_session_name = cna

    [default]
    source_profile = sa-sts
    role_arn = {{ vault('app-sre/integrations-output/terraform-resources/' ~ resource.namespace.cluster.name ~ '/' ~ resource.namespace.name ~ '/cna-service-role-arn', 'role_arn') }}
    role_session_name = cna
