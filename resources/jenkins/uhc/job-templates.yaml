- job-template:
    id: 'uhc-integration-tests'
    name: 'uhc-integration-tests-{environment}'
    node: '{label}'
    wrappers:
    - timeout_wrapper:
        timeout: '{timeout}'
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *uhc_integration_tests
    ci_cmd: ./run_integration_tests.sh
    cron_expression: 0 10,22 * * *
    publishers:
    - junit:
        results: '**/**/junit.xml'
        test-stability: true
        claim-build: true
        measurement-plots: true
        flaky-test-reports: true
        junit-attachments: true
    <<: *gl_timed

- job-template:
    id: 'uhc-cloud-redhat-com-push-insights'
    name: '{gl_group}-{gl_project}-gl-cloud-redhat-com-push-insights-{mode}'
    wrappers:
    - timeout_wrapper:
        timeout: '{timeout}'
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *kube_config
        - *quay_secret_push
        - *uhc_insights_platform
    builders:
    - shell: |
        #!/bin/bash
        set -e
        ./push_to_insights.sh {mode}
    <<: *gl_build_master

- job-template:
    id: 'ocm-pr-check'
    name: '{gl_group}-{gl_project}-ocm-pr-check'
    wrappers:
    - timeout_wrapper:
        timeout: '{timeout}'
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *ocm_sandbox
    publishers:
    - archive:
        artifacts: 'logs/**'
        allow-empty: 'true'
    <<: *gl_pr_check
