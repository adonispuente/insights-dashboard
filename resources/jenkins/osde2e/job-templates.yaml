- job-template:
    id: 'osde2e-metrics-sync'
    name: 'osde2e-metrics-sync'
    wrappers:
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *osde2e-aws-access
        - *osde2e-datahub
        - *app_sre_push_gateway
    <<: *gh_timed
- job-template:
    id: 'osde2e-weather-report'
    name: 'osde2e-weather-report'
    wrappers:
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *osde2e-datahub
    <<: *gh_timed
    publishers:
    - git:
        push-only-if-success: true
        branches:
        - branch:
            remote: origin
            name: gh-pages
- job-template:
    id: 'osde2e-weather-report-to-slack'
    name: 'osde2e-weather-report-to-slack'
    wrappers:
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *osde2e-aws-access
        - *osde2e-datahub
        - *osde2e-slack
    <<: *gh_timed
- job-template:
    id: 'osde2e-granular-alerting'
    name: 'osde2e-granular-alerting'
    wrappers:
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *osde2e-aws-access
        - *osde2e-datahub
        - *osde2e-slack
    <<: *gh_timed
- job-template:
    id: 'osde2e-trigger-jobs'
    name: 'osde2e-trigger-jobs'
    wrappers:
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *app_sre_ci_trigger_jobs_bot
        - *osde2e-trigger-jobs
    triggers:
    - reverse:
        jobs: '{upstream}'
        results: 'success'
    builders:
    - shell:
        command: "{ci_cmd}"
    <<: *gh_checkout
- job-template:
      id: "osde2e-parameterized-job"
      name: "osde2e-parameterized-job"
      instance_type: "m5.xlarge"
      region: "us-east-1"
      report_dir: "/tmp/osde2e-report"
      configs: "rosa,stage,e2e-suite"
      wrappers:
      - vault-secrets:
          <<: *vault_defaults
          secrets:
          - *osde2e-aws-keys
          - *osde2e-ocm-access
      builders:
      - shell:
          command: "{ci_cmd}"
      parameters:
      - string:
          name: INSTANCE_TYPE
          default: "{instance_type}"
      - string:
          name: CLOUD_PROVIDER_REGION
          default: "{region}"
      - string:
          name: REPORT_DIR
          default: "{report_dir}"    
      - string:
          name: CONFIGS
          default: "{configs}"
      - bool:
          name: STS
          default: true    
      - choice:
          name: ENVIRONMENT
          choices:
            - prod
            - stage
          default: "stage"
          description: "OCM environment"
      publishers:
      - archive:
          artifacts: "{report_dir}"    
          allow-empty: 'false'
      properties:
      - build-discarder:
          days-to-keep: 30
          artifact-days-to-keep: 30
      <<: *gh_checkout
