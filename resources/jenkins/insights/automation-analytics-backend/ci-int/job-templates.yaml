
- job-template:
    id: 'insights-automation-analytics-backend-sonarqube-gl-pr-check'
    name: '{gl_group}-{gl_project}-sonarqube-pr-check'
    status_context: "ci.int.devshift.net PR build"
    branch: "master"
    wrappers:
    - timeout_wrapper:
        timeout: '{timeout}'
    - ansicolor
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *insights_ephemeral_oc_login
        - *app_interface_creds
        - *insights_rh_registry_pull_secret
        - *quay_secret_push
        - *quay_api_token
        - *insightsdroid_github
        - *insights_automation_analytics_backend_sonarqube_token
        - *insights_automation_analytics_backend_rh_it_root_ca
    publishers:
    - junit:
        results: 'artifacts/junit-*.xml'
    - archive:
        artifacts: 'artifacts/**/*'
    <<: *gl_pr_check

- job-template:
    id: 'insights-automation-analytics-backend-sonarqube-gl-build-master'
    name: '{gl_group}-{gl_project}-sonarqube-gl-build-{branch}'
    wrappers:
    - timeout_wrapper:
        timeout: '{timeout}'
    - ansicolor
    - vault-secrets:
        <<: *vault_defaults
        secrets:
        - *insights_rh_registry_pull_secret
        - *quay_secret_push
        - *quay_api_token
        - *insights_automation_analytics_backend_sonarqube_token
        - *insights_automation_analytics_backend_rh_it_root_ca
    <<: *gl_build_master
