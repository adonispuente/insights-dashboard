# Clair v4 - Index report availability SLO/SLI

## SLI description
We want to measure the how often Clair's vulnerability report endpoint returns a non-succesful response.

## SLI rationale
In order for Quay.io to display security information for given tags it needs to request that information from Clair. A non successful response for a vulnerability report leads to users not being able to see any vulnerability information.
## Implementation details

### Error Rate
We count the number of API requests that have a `5xx` status code and divide it by the total of all the API requests made. We use the metric `haproxy_server_http_responses_total` with the label filters `{exported_namespace="clair-production", route="clair-matcher-production"}` and the label `code` to calculate the error rate.
## SLO rationale
Clair is expected to respond successfully 98 percent of the time to requests for vulnerability reports in order to maintain a good user experience for the vast majority of Quay.io users.
## Alerting
The following are the list of alerts that are associated with this SLO.

- `ClairVulnerabilityReportAPI30mto6hErrorBudgetBurn`
- `ClairVulnerabilityReportAPI2hto1dErrorBudgetBurn`
